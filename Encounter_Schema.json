{
    "$schema": "http://json-schema.org/draft-07/schema#",
    "title": "Encounter",
    "type": "object",
    "properties": {
        "encounterId": {
            "type": "string",
            "description": "Unique identifier for the encounter"
        },
        "party": {
            "type": "array",
            "description": "List of player characters in the party",
            "items": {
                "type": "object",
                "properties": {
                    "id": {
                        "type": "integer",
                        "autoIncrement": true,
                        "isRequired": true
                    },
                    "name": {
                        "type": "string",
                        "isRequired": true
                    },
                    "level": {
                        "type": "integer",
                        "minimum": 1,
                        "maximum": 20,
                        "isRequired": true
                    },
                    "class": {
                        "type": "string",
                        "enum": [
                            "barbarian",
                            "bard",
                            "cleric",
                            "druid",
                            "fighter",
                            "monk",
                            "paladin",
                            "ranger",
                            "rogue",
                            "sorcerer",
                            "warlock",
                            "wizard"
                        ],
                        "isRequired": true
                    },
                    "subclass": {
                        "type": "string",
                        "enum": [
                            "Berserker",
                            "Lore",
                            "Champion",
                            "Open Hand",
                            "Devotion",
                            "Land",
                            "Thief",
                            "Draconic",
                            "Evocation",
                            "Life",
                            "Hunter",
                            "Fiend"
                        ]
                    },
                    "maxHp": {
                        "type": "integer",
                        "minimum": 1,
                        "isRequired": true
                    },
                    "startHp": {
                        "type": "integer",
                        "minimum": 0,
                        "isRequired": true
                    },
                    "ac": {
                        "type": "integer",
                        "minimum": 0,
                        "maximum": 30,
                        "isRequired": true
                    },
                    "initiative": {
                        "type": "integer",
                        "isRequired": true
                    },
                    "strength": {
                        "$ref": "#/definitions/attribute",
                        "isRequired": true
                    },
                    "dexterity": {
                        "$ref": "#/definitions/attribute",
                        "isRequired": true
                    },
                    "constitution": {
                        "$ref": "#/definitions/attribute",
                        "isRequired": true
                    },
                    "intelligence": {
                        "$ref": "#/definitions/attribute",
                        "isRequired": true
                    },
                    "wisdom": {
                        "$ref": "#/definitions/attribute",
                        "isRequired": true
                    },
                    "charisma": {
                        "$ref": "#/definitions/attribute",
                        "isRequired": true
                    },
                    "speed": {
                        "type": "integer",
                        "minimum": 0,
                        "isRequired": true
                    },
                    "proficiencyBonus": {
                        "type": "integer",
                        "minimum": 2,
                        "maximum": 6,
                        "isRequired": true
                    },
                    "proficiencies": {
                        "type": "array",
                        "items": {
                            "type": "string",
                            "enum": [
                                "acrobatics",
                                "animal_handling",
                                "arcana",
                                "athletics",
                                "deception",
                                "history",
                                "insight",
                                "intimidation",
                                "investigation",
                                "medicine",
                                "nature",
                                "perception",
                                "performance",
                                "persuasion",
                                "religion",
                                "sleight_of_hand",
                                "stealth",
                                "survival"
                            ],
                            "default": []
                        },
                        "isRequired": true
                    },
                    "masteries": {
                        "type": "array",
                        "items": {
                            "type": "string",
                            "enum": [
                                "acrobatics",
                                "animal_handling",
                                "arcana",
                                "athletics",
                                "deception",
                                "history",
                                "insight",
                                "intimidation",
                                "investigation",
                                "medicine",
                                "nature",
                                "perception",
                                "performance",
                                "persuasion",
                                "religion",
                                "sleight_of_hand",
                                "stealth",
                                "survival"
                            ],
                            "default": []
                        }
                    },
                    "features": {
                        "type": "array",
                        "items": {
                            "$ref": "#/definitions/feature"
                        },
                        "default": []
                    },
                    "vulnerabilities": {
                        "type": "array",
                        "items": {
                            "type": "string",
                            "enum": [
                                "Acid",
                                "Cold",
                                "Thunder",
                                "Necrotic",
                                "Piercing",
                                "Psychic",
                                "Fire",
                                "Radiant",
                                "Slashing",
                                "Bludgeoning",
                                "Force",
                                "Lightning",
                                "Poison"
                            ]
                        },
                        "default": []
                    },
                    "resistances": {
                        "type": "array",
                        "items": {
                            "type": "string",
                            "enum": [
                                "Acid",
                                "Cold",
                                "Thunder",
                                "Necrotic",
                                "Piercing",
                                "Psychic",
                                "Fire",
                                "Radiant",
                                "Slashing",
                                "Bludgeoning",
                                "Force",
                                "Lightning",
                                "Poison"
                            ]
                        },
                        "default": []
                    },
                    "immunities": {
                        "type": "array",
                        "items": {
                            "type": "string",
                            "enum": [
                                "Acid",
                                "Cold",
                                "Thunder",
                                "Necrotic",
                                "Piercing",
                                "Psychic",
                                "Fire",
                                "Radiant",
                                "Slashing",
                                "Bludgeoning",
                                "Force",
                                "Lightning",
                                "Poison"
                            ]
                        },
                        "default": []
                    },
                    "actions": {
                        "type": "array",
                        "items": {
                            "$ref": "#/definitions/action"
                        },
                        "default": []
                    },
                    "casting": {
                        "$ref": "#/definitions/casting",
                        "isRequired": true
                    }
                }
            }
        },
        "monsters": {
            "type": "array",
            "description": "List of monsters in the encounter",
            "items": {
                "type": "object",
                "properties": {
                    "id": {
                        "type": "integer",
                        "autoIncrement": true,
                        "isRequired": true
                    },
                    "name": {
                        "type": "string",
                        "isRequired": true
                    },
                    "cr": {
                        "type": "number",
                        "minimum": 0,
                        "isRequired": true
                    },
                    "hp": {
                        "type": "integer",
                        "minimum": 1,
                        "isRequired": true
                    },
                    "ac": {
                        "type": "integer",
                        "minimum": 0,
                        "maximum": 30,
                        "isRequired": true
                    },
                    "initiative": {
                        "type": "integer",
                        "isRequired": true
                    },
                    "strength": {
                        "$ref": "#/definitions/attribute",
                        "isRequired": true
                    },
                    "dexterity": {
                        "$ref": "#/definitions/attribute",
                        "isRequired": true
                    },
                    "constitution": {
                        "$ref": "#/definitions/attribute",
                        "isRequired": true
                    },
                    "intelligence": {
                        "$ref": "#/definitions/attribute",
                        "isRequired": true
                    },
                    "wisdom": {
                        "$ref": "#/definitions/attribute",
                        "isRequired": true
                    },
                    "charisma": {
                        "$ref": "#/definitions/attribute",
                        "isRequired": true
                    },
                    "speed": {
                        "type": "integer",
                        "minimum": 0,
                        "isRequired": true
                    },
                    "proficiencies": {
                        "type": "array",
                        "items": {
                            "type": "string",
                            "enum": [
                                "acrobatics",
                                "animal_handling",
                                "arcana",
                                "athletics",
                                "deception",
                                "history",
                                "insight",
                                "intimidation",
                                "investigation",
                                "medicine",
                                "nature",
                                "perception",
                                "performance",
                                "persuasion",
                                "religion",
                                "sleight_of_hand",
                                "stealth",
                                "survival"
                            ]
                        },
                        "default": []
                    },
                    "masteries": {
                        "type": "array",
                        "items": {
                            "type": "string",
                            "enum": [
                                "acrobatics",
                                "animal_handling",
                                "arcana",
                                "athletics",
                                "deception",
                                "history",
                                "insight",
                                "intimidation",
                                "investigation",
                                "medicine",
                                "nature",
                                "perception",
                                "performance",
                                "persuasion",
                                "religion",
                                "sleight_of_hand",
                                "stealth",
                                "survival"
                            ]
                        },
                        "default": []
                    },
                    "vulnerabilities": {
                        "type": "array",
                        "items": {
                            "type": "string",
                            "enum": [
                                "Acid",
                                "Cold",
                                "Thunder",
                                "Necrotic",
                                "Piercing",
                                "Psychic",
                                "Fire",
                                "Radiant",
                                "Slashing",
                                "Bludgeoning",
                                "Force",
                                "Lightning",
                                "Poison"
                            ]
                        },
                        "default": []
                    },
                    "resistances": {
                        "type": "array",
                        "items": {
                            "type": "string",
                            "enum": [
                                "Acid",
                                "Cold",
                                "Thunder",
                                "Necrotic",
                                "Piercing",
                                "Psychic",
                                "Fire",
                                "Radiant",
                                "Slashing",
                                "Bludgeoning",
                                "Force",
                                "Lightning",
                                "Poison"
                            ]
                        },
                        "default": []
                    },
                    "immunities": {
                        "type": "array",
                        "items": {
                            "type": "string",
                            "enum": [
                                "Acid",
                                "Cold",
                                "Thunder",
                                "Necrotic",
                                "Piercing",
                                "Psychic",
                                "Fire",
                                "Radiant",
                                "Slashing",
                                "Bludgeoning",
                                "Force",
                                "Lightning",
                                "Poison"
                            ]
                        },
                        "default": []
                    },
                    "actions": {
                        "$ref": "#/definitions/action",
                        "isRequired": true
                    },
                    "spells": {
                        "$ref": "#/definitions/spell",
                        "default": []
                    },
                    "legendaryActions": {
                        "type": "object",
                        "properties": {
                            "numActions": {
                                "type": "integer",
                                "minimum": 0
                            },
                            "actions": {
                                "type": "array",
                                "items": {
                                    "$ref": "#/definitions/legendaryAction"
                                }
                            }
                        },
                        "default": {
                            "numActions": 0,
                            "actions": []
                        }
                    },
                    "legendaryResistances": {
                        "type": "object",
                        "properties": {
                            "numResistances": {
                                "type": "integer",
                                "minimum": 0
                            },
                            "resistances": {
                                "type": "array",
                                "items": {
                                    "type": "string"
                                }
                            }
                        },
                        "default": {
                            "numResistances": 0,
                            "resistances": []
                        }
                    }
                }
            }
        },
        "rounds": {
            "type": "array",
            "properties": {
                "round": {
                    "type": "integer",
                    "minimum": 1,
                    "autoIncrement": true
                },
                "turns": {
                    "type": "array",
                    "items": {
                        "type": "object",
                        "properties": {
                            "entity": {
                                "type": "string",
                                "isRequired": true
                            },
                            "action": {
                                "type": "string",
                                "isRequired": true
                            },
                            "damageDealt": {
                                "type": "array",
                                "items": {
                                    "type": "object",
                                    "properties": {
                                        "target": {
                                            "type": "string",
                                            "isRequired": true
                                        },
                                        "amount": {
                                            "type": "integer",
                                            "minimum": 0,
                                            "default": 0
                                        },
                                        "damageType": {
                                            "type": "string",
                                            "enum": [
                                                "Acid",
                                                "Cold",
                                                "Thunder",
                                                "Necrotic",
                                                "Piercing",
                                                "Psychic",
                                                "Fire",
                                                "Radiant",
                                                "Slashing",
                                                "Bludgeoning",
                                                "Force",
                                                "Lightning",
                                                "Poison"
                                            ],
                                            "default": ""
                                        }
                                    }
                                },
                                "default": []
                            },
                            "healingDone": {
                                "type": "array",
                                "items": {
                                    "type": "object",
                                    "properties": {
                                        "target": {
                                            "type": "string",
                                            "isRequired": true
                                        },
                                        "amount": {
                                            "type": "integer",
                                            "minimum": 0,
                                            "default": 0
                                        }
                                    }
                                },
                                "default": []
                            },
                            "notes": {
                                "type": "string"
                            }
                        }
                    }
                }
            }
        },
        "outcome": {
            "type": "object",
            "properties": {
                "result": {
                    "type": "string",
                    "enum": [
                        "victory",
                        "defeat"
                    ],
                    "isRequired": true
                },
                "rounds": {
                    "type": "integer",
                    "minimum": 1,
                    "default": 1
                },
                "notes": {
                    "type": "string",
                    "isRequired": true
                }
            }
        },
        "definitions": {
            "attribute": {
                "type": "object",
                "properties": {
                    "value": {
                        "type": "integer",
                        "minimum": 1,
                        "maximum": 30
                    },
                    "modifier": {
                        "type": "integer",
                        "minimum": -5,
                        "maximum": 10
                    },
                    "save": {
                        "type": "integer",
                        "minimum": -5,
                        "maximum": 10
                    }
                }
            },
            "feature": {
                "type": "object",
                "properties": {
                    "index": {
                        "type": "string"
                    },
                    "name": {
                        "type": "string"
                    },
                    "descriptions": {
                        "type": "array",
                        "items": {
                            "type": "string"
                        }
                    }
                }
            },
            "action": {
                "type": "object",
                "properties": {
                    "index": {
                        "type": "string"
                    },
                    "name": {
                        "type": "string"
                    },
                    "type": {
                        "type": "string",
                        "enum": [
                            "melee",
                            "ranged",
                            "special"
                        ]
                    },
                    "damage": {
                        "$ref": "#/definitions/damage"
                    },
                    "range": {
                        "type": "integer"
                    },
                    "damageType": {
                        "type": "string",
                        "enum": [
                            "Acid",
                            "Cold",
                            "Thunder",
                            "Necrotic",
                            "Piercing",
                            "Psychic",
                            "Fire",
                            "Radiant",
                            "Slashing",
                            "Bludgeoning",
                            "Force",
                            "Lightning",
                            "Poison"
                        ]
                    },
                    "properties": {
                        "type": "array",
                        "items": {
                            "type": "string",
                            "enum": [
                                "Finesse",
                                "Light",
                                "Reach",
                                "Thrown",
                                "Two-Handed",
                                "Ammunition",
                                "Heavy",
                                "Special",
                                "Versatile",
                                "Monk",
                                "Loading"
                            ]
                        }
                    },
                    "description": {
                        "type": "string"
                    }
                }
            },
            "damage": {
                "type": "object",
                "properties": {
                    "minimum": {
                        "type": "integer"
                    },
                    "maximum": {
                        "type": "integer"
                    }
                }
            },
            "spell": {
                "type": "object",
                "properties": {
                    "index": {
                        "type": "string"
                    },
                    "name": {
                        "type": "string"
                    },
                    "level": {
                        "type": "integer",
                        "minimum": 0,
                        "maximum": 9
                    },
                    "toHit": {
                        "type": "integer"
                    },
                    "saveDC": {
                        "type": "integer"
                    },
                    "damage": {
                        "type": "string"
                    },
                    "damageType": {
                        "type": "string",
                        "enum": [
                            "Acid",
                            "Cold",
                            "Thunder",
                            "Necrotic",
                            "Piercing",
                            "Psychic",
                            "Fire",
                            "Radiant",
                            "Slashing",
                            "Bludgeoning",
                            "Force",
                            "Lightning",
                            "Poison"
                        ]
                    },
                    "range": {
                        "type": "string"
                    },
                    "target": {
                        "type": "string"
                    },
                    "description": {
                        "type": "string"
                    }
                }
            },
            "legendaryAction": {
                "type": "string"
            },
            "casting": {
                "type": "object",
                "properties": {
                    "hasSpellcasting": {
                        "type": "boolean"
                    },
                    "spellSaveDC": {
                        "type": "integer"
                    },
                    "spellAttackBonus": {
                        "type": "integer"
                    },
                    "spellAttribute": {
                        "type": "string",
                        "enum": [
                            "strength",
                            "dexterity",
                            "constitution",
                            "intelligence",
                            "wisdom",
                            "charisma"
                        ]
                    },
                    "spellSlots": {
                        "type": "object",
                        "properties": {
                            "level1": {
                                "type": "integer",
                                "minimum": 0,
                                "maximum": 4
                            },
                            "level2": {
                                "type": "integer",
                                "minimum": 0,
                                "maximum": 4
                            },
                            "level3": {
                                "type": "integer",
                                "minimum": 0,
                                "maximum": 4
                            },
                            "level4": {
                                "type": "integer",
                                "minimum": 0,
                                "maximum": 4
                            },
                            "level5": {
                                "type": "integer",
                                "minimum": 0,
                                "maximum": 4
                            },
                            "level6": {
                                "type": "integer",
                                "minimum": 0,
                                "maximum": 4
                            },
                            "level7": {
                                "type": "integer",
                                "minimum": 0,
                                "maximum": 4
                            },
                            "level8": {
                                "type": "integer",
                                "minimum": 0,
                                "maximum": 4
                            },
                            "level9": {
                                "type": "integer",
                                "minimum": 0,
                                "maximum": 4
                            }
                        }
                    },
                    "spells": {
                        "type": "array",
                        "items": {
                            "$ref": "#/definitions/spell"
                        }
                    }
                }
            }
        }
    },
    "required": [
        "encounterId",
        "party",
        "monsters",
        "rounds",
        "outcome"
    ]
}